<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="bkmr">
<title>Example_analysis • bkmr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Example_analysis">
<meta property="og:description" content="bkmr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">bkmr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Example_analysis.html">Example_analysis</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/jenfb/bkmr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Example_analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jenfb/bkmr/blob/HEAD/vignettes/Example_analysis.Rmd" class="external-link"><code>vignettes/Example_analysis.Rmd</code></a></small>
      <div class="d-none name"><code>Example_analysis.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="author-information">Author Information<a class="anchor" aria-label="anchor" href="#author-information"></a>
</h3>
<p>Sunan Gao</p>
<p>Johns Hopkins University</p>
<p>Bloomberg School of Public Health</p>
<p><a href="mailto:sgao57@jh.edu" class="email">sgao57@jh.edu</a></p>
</div>
<div class="section level2">
<h2 id="the-package-i-choose-">The package I choose.<a class="anchor" aria-label="anchor" href="#the-package-i-choose-"></a>
</h2>
<p>Package: <code>bkmr</code></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jenfb/bkmr" class="external-link">bkmr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; For guided examples, go to 'https://jenfb.github.io/bkmr/overview.html'</span></span></code></pre></div>
<div class="section level3">
<h3 id="research-question">Research Question<a class="anchor" aria-label="anchor" href="#research-question"></a>
</h3>
<ul>
<li>The cost distribution under different variables.</li>
<li>The association between Room and board and Tuition for in-state
residents (Total cost).</li>
<li>Try to use Bayesian kernel machine regression to explore unlinear
assocition between multivariables and cost.</li>
</ul>
</div>
<div class="section level3">
<h3 id="original-data">Original Data<a class="anchor" aria-label="anchor" href="#original-data"></a>
</h3>
<ul>
<li>Data was downloaded from TidyTuesday. The data this week comes from
many different sources but originally came from the US Department of
Education. Tuition and fees by college/university for 2018-2019, along
with school type, degree length, state, in-state vs out-of-state from
the Chronicle of Higher Education. <a href="https://github.com/rfordatascience/tidytuesday/blob/master/data/2020/2020-03-10/readme.md" class="external-link">Data
Source</a>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="data-dictionary">Data Dictionary<a class="anchor" aria-label="anchor" href="#data-dictionary"></a>
</h3>
<ul>
<li>Here is a data dictionary for what all the column names mean:   <a href="https://github.com/rfordatascience/tidytuesday/blob/master/data/2020/2020-03-10/readme.md#data-dictionary" class="external-link">data
dictionary</a>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="load-the-data-into-r">Load the data into R<a class="anchor" aria-label="anchor" href="#load-the-data-into-r"></a>
</h3>
<p>Download example data from github and save them in the local
site.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://tidyverse.tidyverse.org" class="external-link">"tidyverse"</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"tidyverse"</span>, repos <span class="op">=</span> <span class="st">"http://cran.us.r-project.org"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Attaching core tidyverse packages</span> ──────────────────────── tidyverse 2.0.0 ──</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dplyr    </span> 1.1.2     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">readr    </span> 2.1.4</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">forcats  </span> 1.0.0     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">stringr  </span> 1.5.0</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">ggplot2  </span> 3.4.3     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tibble   </span> 3.2.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">lubridate</span> 1.9.2     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tidyr    </span> 1.3.0</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">purrr    </span> 1.0.2     </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Conflicts</span> ────────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span> masks <span style="color: #0000BB;">stats</span>::filter()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>    masks <span style="color: #0000BB;">stats</span>::lag()</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use the conflicted package (<span style="color: #0000BB; font-style: italic;">&lt;http://conflicted.r-lib.org/&gt;</span>) to force all conflicts to become errors</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://github.com/thebioengineer/tidytuesdayR" class="external-link">"tidytuesdayR"</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"tidytuesdayR"</span>, repos <span class="op">=</span> <span class="st">"http://cran.us.r-project.org"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://here.r-lib.org/" class="external-link">"here"</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"here"</span>, repos <span class="op">=</span> <span class="st">"http://cran.us.r-project.org"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; here() starts at /Users/gsn/Desktop/2023-2024/【JHU】Term-2/【Core】Statistical Programming Workflow/bkmr</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">"ggplot2"</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ggplot2"</span>, repos <span class="op">=</span> <span class="st">"http://cran.us.r-project.org"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://purrr.tidyverse.org/" class="external-link">"purrr"</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"purrr"</span>, repos <span class="op">=</span> <span class="st">"http://cran.us.r-project.org"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/" class="external-link">here</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Test if a directory named data exists locally. If it does not, write an R function that creates it programmatically. Saves the data only once</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"tuesdata_tution_cost.csv"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">tuesdata</span> <span class="op">&lt;-</span> <span class="fu">tidytuesdayR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tidytuesdayR/man/tt_load.html" class="external-link">tt_load</a></span><span class="op">(</span><span class="st">'2020-03-10'</span><span class="op">)</span></span>
<span>    <span class="va">tuition_cost</span> <span class="op">&lt;-</span> <span class="va">tuesdata</span><span class="op">$</span><span class="va">tuition_cost</span></span>
<span>    <span class="va">tuition_income</span> <span class="op">&lt;-</span> <span class="va">tuesdata</span><span class="op">$</span><span class="va">tuition_income</span></span>
<span>    </span>
<span>    </span>
<span>    <span class="va">save_directory</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"data"</span><span class="op">)</span> <span class="co"># File for saving data, must be created</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.exists</a></span><span class="op">(</span><span class="va">save_directory</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">save_directory</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="co"># save the files to csv objects ()</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">tuesdata</span><span class="op">$</span><span class="va">tuition_cost</span>, file <span class="op">=</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"tuesdata_tuition_cost.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">tuesdata</span><span class="op">$</span><span class="va">tuition_income</span>, file <span class="op">=</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">'data'</span>, <span class="st">'tuesdata_tuition_income.csv'</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; --- Compiling #TidyTuesday Information for 2020-03-10 ----</span></span>
<span><span class="co">#&gt; --- There are 5 files available ---</span></span>
<span><span class="co">#&gt; --- Starting Download ---</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Downloading file 1 of 5: `diversity_school.csv`</span></span>
<span><span class="co">#&gt;  Downloading file 2 of 5: `historical_tuition.csv`</span></span>
<span><span class="co">#&gt;  Downloading file 3 of 5: `salary_potential.csv`</span></span>
<span><span class="co">#&gt;  Downloading file 4 of 5: `tuition_cost.csv`</span></span>
<span><span class="co">#&gt;  Downloading file 5 of 5: `tuition_income.csv`</span></span>
<span><span class="co">#&gt; --- Download complete ---</span></span>
<span><span class="co">## Read in the data locally each time you knit/render</span></span>
<span><span class="va">tuition_cost</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"tuesdata_tuition_cost.csv"</span><span class="op">)</span><span class="op">)</span>; <span class="va">tuition_cost</span><span class="op">$</span><span class="va">X</span> <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="va">tuition_income</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"tuesdata_tuition_income.csv"</span><span class="op">)</span><span class="op">)</span>; <span class="va">tuition_income</span><span class="op">$</span><span class="va">X</span> <span class="op">=</span> <span class="cn">NULL</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 1. Start with tuition cost dataset and drop any rows with NAs.</span></span>
<span><span class="va">tuition_cost</span> <span class="op">&lt;-</span> <span class="va">tuition_cost</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">drop_na</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. Convert the state names (character strings) to all upper case.</span></span>
<span><span class="va">tuition_cost</span> <span class="op">&lt;-</span> <span class="va">tuition_cost</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>state <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html" class="external-link">str_to_upper</a></span><span class="op">(</span><span class="va">state</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3. Create new column titled state_code_type that combines the state_code and school type into one column separated by “-”. (e.g. “TX-Private”).</span></span>
<span><span class="va">tuition_cost</span> <span class="op">&lt;-</span> <span class="va">tuition_cost</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unite.html" class="external-link">unite</a></span><span class="op">(</span><span class="va">state_code_type</span>, <span class="va">state_code</span>, <span class="va">type</span>, sep <span class="op">=</span> <span class="st">'-'</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate the distribution of room and board of different schooles</span></span>
<span><span class="va">tuition_cost_summary</span> <span class="op">&lt;-</span> <span class="va">tuition_cost</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">state_code_type</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    mean_room_and_board <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">room_and_board</span><span class="op">)</span>,</span>
<span>    sd_room_and_board <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">room_and_board</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tuition_cost_summary</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   state_code_type mean_room_and_board sd_room_and_board</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> AK-Private                    <span style="text-decoration: underline;">6</span>500              <span style="text-decoration: underline;">1</span>131.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> AK-Public                    <span style="text-decoration: underline;">10</span>832.             <span style="text-decoration: underline;">2</span>070.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> AL-Private                    <span style="text-decoration: underline;">8</span>800.             <span style="text-decoration: underline;">2</span>366.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> AL-Public                     <span style="text-decoration: underline;">6</span>994.             <span style="text-decoration: underline;">2</span>815.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> AR-Private                    <span style="text-decoration: underline;">8</span>147.             <span style="text-decoration: underline;">1</span>670.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> AR-Public                     <span style="text-decoration: underline;">7</span>315.             <span style="text-decoration: underline;">2</span>024.</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate the distribution of body mass of penguins</span></span>
<span><span class="va">tuition_cost_summary2</span> <span class="op">&lt;-</span> <span class="va">tuition_cost</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">room_and_board</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">state_code_type</span>, <span class="va">degree_length</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    mean_in <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">in_state_tuition</span><span class="op">)</span>,</span>
<span>    sd_mass <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">in_state_tuition</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'state_code_type'. You can override using</span></span>
<span><span class="co">#&gt; the `.groups` argument.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tuition_cost_summary2</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   state_code_type [4]</span></span></span>
<span><span class="co">#&gt;   state_code_type degree_length mean_in sd_mass</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> AK-Private      4 Year         <span style="text-decoration: underline;">15</span>065    <span style="text-decoration: underline;">8</span>153.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> AK-Public       2 Year          <span style="text-decoration: underline;">4</span>300      <span style="color: #BB0000;">NA</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> AK-Public       4 Year          <span style="text-decoration: underline;">7</span>622.    501.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> AL-Private      4 Year         <span style="text-decoration: underline;">18</span>896.   <span style="text-decoration: underline;">8</span>853.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> AL-Public       2 Year          <span style="text-decoration: underline;">5</span>433.   <span style="text-decoration: underline;">1</span>758.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> AL-Public       4 Year         <span style="text-decoration: underline;">10</span>805.    920.</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># combine the observed data and summarized result</span></span>
<span><span class="va">tuition_cost_combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">tuition_cost</span>, <span class="va">tuition_cost_summary</span>, <span class="st">'state_code_type'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tuition_cost_combined</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                   name      state state_code_type degree_length</span></span>
<span><span class="co">#&gt; 1         Abilene Christian University      TEXAS      TX-Private        4 Year</span></span>
<span><span class="co">#&gt; 2 Abraham Baldwin Agricultural College    GEORGIA       GA-Public        2 Year</span></span>
<span><span class="co">#&gt; 3            Academy of Art University CALIFORNIA   CA-For Profit        4 Year</span></span>
<span><span class="co">#&gt; 4               Adams State University   COLORADO       CO-Public        4 Year</span></span>
<span><span class="co">#&gt; 5                   Adelphi University   NEW YORK      NY-Private        4 Year</span></span>
<span><span class="co">#&gt; 6         Adirondack Community College   NEW YORK       NY-Public        2 Year</span></span>
<span><span class="co">#&gt;   room_and_board in_state_tuition in_state_total out_of_state_tuition</span></span>
<span><span class="co">#&gt; 1          10350            34850          45200                34850</span></span>
<span><span class="co">#&gt; 2           8474             4128          12602                12550</span></span>
<span><span class="co">#&gt; 3          16648            27810          44458                27810</span></span>
<span><span class="co">#&gt; 4           8782             9440          18222                20456</span></span>
<span><span class="co">#&gt; 5          16030            38660          54690                38660</span></span>
<span><span class="co">#&gt; 6          11660             5375          17035                 9935</span></span>
<span><span class="co">#&gt;   out_of_state_total mean_room_and_board sd_room_and_board</span></span>
<span><span class="co">#&gt; 1              45200            9228.690          3037.913</span></span>
<span><span class="co">#&gt; 2              21024            9383.154          1844.827</span></span>
<span><span class="co">#&gt; 3              44458           13824.000          3993.739</span></span>
<span><span class="co">#&gt; 4              29238            9853.188          2384.372</span></span>
<span><span class="co">#&gt; 5              54690           11868.307          4704.870</span></span>
<span><span class="co">#&gt; 6              21595           12582.260          2289.362</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tuition_cost_combined</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">room_and_board</span>, y <span class="op">=</span> <span class="va">in_state_total</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">room_and_board</span>, y <span class="op">=</span> <span class="va">in_state_total</span><span class="op">)</span>,  linetype <span class="op">=</span> <span class="st">"solid"</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">rainbow</a></span><span class="op">(</span><span class="fl">1861</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Association between the Room and board and total tution in state"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">'Point Chart: Room and board (USD) ~ Total tution (USD)'</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"Data from the Chronicle of Higher Education"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Room and board in (USD)"</span>, y <span class="op">=</span> <span class="st">"Total tution (USD)"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">degree_length</span>, ncol <span class="op">=</span> <span class="cn">NULL</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Example_analysis_files/figure-html/unnamed-chunk-8-1.png" width="576"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tuition_cost_combined</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">state</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">room_and_board</span><span class="op">&gt;</span><span class="fl">10000</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Mean_diff <span class="op">=</span> <span class="va">out_of_state_total</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out_of_state_total</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">state</span>, y <span class="op">=</span> <span class="va">Mean_diff</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">rainbow</a></span><span class="op">(</span><span class="fl">931</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"The distribution of the total cost out of state difference in each state"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">'relative to the mean level at different state'</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"Data from the Chronicle of Higher Education"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"State"</span>, y <span class="op">=</span> <span class="st">"The difference bewteen mean value and observations in each group"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span>, size<span class="op">=</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Example_analysis_files/figure-html/unnamed-chunk-9-1.png" width="576">
#### BKMR Model <a href="https://jenfb.github.io/bkmr/overview.html" class="external-link">Using
reference</a></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jenfb/bkmr" class="external-link">bkmr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">tuition_cost_combined</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "name"                 "state"                "state_code_type"     </span></span>
<span><span class="co">#&gt;  [4] "degree_length"        "room_and_board"       "in_state_tuition"    </span></span>
<span><span class="co">#&gt;  [7] "in_state_total"       "out_of_state_tuition" "out_of_state_total"  </span></span>
<span><span class="co">#&gt; [10] "mean_room_and_board"  "sd_room_and_board"</span></span>
<span><span class="va">data</span> <span class="op">=</span> <span class="va">tuition_cost_combined</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'room_and_board'</span>,</span>
<span>                                 <span class="st">'degree_length'</span>, </span>
<span>                                 <span class="st">'mean_room_and_board'</span>,</span>
<span>                                 <span class="st">'room_and_board'</span>,</span>
<span>                                 <span class="st">'in_state_tuition'</span>,</span>
<span>                                 <span class="st">'in_state_total'</span>,</span>
<span>                                 <span class="st">'out_of_state_total'</span>,</span>
<span>                                 <span class="st">'state'</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">data_unique</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span><span class="va">data</span><span class="op">$</span><span class="va">out_of_state_total</span> <span class="op">&lt;</span> <span class="fl">20000</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SimData.html">SimData</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">data_unique</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, M <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="co"># introduce some nuisance data</span></span></code></pre></div>
<div class="section level4">
<h4 id="adopt-purrr-function-to-facilitate-process">Adopt purrr function to facilitate process<a class="anchor" aria-label="anchor" href="#adopt-purrr-function-to-facilitate-process"></a>
</h4>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## explore linear regression</span></span>
<span><span class="va">by_degree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">data_unique</span>, <span class="va">data_unique</span><span class="op">$</span><span class="va">degree_length</span><span class="op">)</span></span>
<span><span class="va">by_degree</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span>.f <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">out_of_state_total</span> <span class="op">~</span> <span class="va">state</span>, data <span class="op">=</span> <span class="va">.x</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span>.f <span class="op">=</span> <span class="va">coef</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`2 Year`</span></span>
<span><span class="co">#&gt;         (Intercept)         stateALASKA        stateARIZONA       stateARKANSAS </span></span>
<span><span class="co">#&gt;          12548.5000           4751.5000            881.0714            744.8333 </span></span>
<span><span class="co">#&gt;     stateCALIFORNIA       stateCOLORADO        stateGEORGIA          stateIDAHO </span></span>
<span><span class="co">#&gt;           2599.5000           2048.9000           2105.5000           3759.0000 </span></span>
<span><span class="co">#&gt;           stateIOWA         stateKANSAS      stateLOUISIANA          stateMAINE </span></span>
<span><span class="co">#&gt;           1145.7500          -2841.7222           3875.5000           1621.5000 </span></span>
<span><span class="co">#&gt;       stateMARYLAND       stateMICHIGAN      stateMINNESOTA    stateMISSISSIPPI </span></span>
<span><span class="co">#&gt;           5596.5000           1489.1667          -1316.3000          -2936.3571 </span></span>
<span><span class="co">#&gt;       stateMISSOURI        stateMONTANA       stateNEBRASKA     stateNEW JERSEY </span></span>
<span><span class="co">#&gt;            886.9444           -569.2500          -1423.2500           2556.5000 </span></span>
<span><span class="co">#&gt;     stateNEW MEXICO       stateNEW YORK   stateNORTH DAKOTA           stateOHIO </span></span>
<span><span class="co">#&gt;          -5693.2500           4952.3333            919.8333           3317.0000 </span></span>
<span><span class="co">#&gt;       stateOKLAHOMA         stateOREGON   statePENNSYLVANIA stateSOUTH CAROLINA </span></span>
<span><span class="co">#&gt;           3427.0455           -253.1667           4746.5000           3824.0000 </span></span>
<span><span class="co">#&gt;          stateTEXAS           stateUTAH     stateWASHINGTON  stateWEST VIRGINIA </span></span>
<span><span class="co">#&gt;          -1126.3276            -53.5000            944.0714           7351.5000 </span></span>
<span><span class="co">#&gt;      stateWISCONSIN        stateWYOMING </span></span>
<span><span class="co">#&gt;           3015.7500           1762.9286 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`4 Year`</span></span>
<span><span class="co">#&gt;         (Intercept)         stateALASKA        stateARIZONA       stateARKANSAS </span></span>
<span><span class="co">#&gt;          17392.3333          -2392.3333          -5063.3333            675.0000 </span></span>
<span><span class="co">#&gt;     stateCALIFORNIA        stateFLORIDA        stateGEORGIA         stateHAWAII </span></span>
<span><span class="co">#&gt;          -1894.3333           -411.9333          -1512.3333          -5246.3333 </span></span>
<span><span class="co">#&gt;          stateIDAHO           stateIOWA         stateKANSAS       stateKENTUCKY </span></span>
<span><span class="co">#&gt;          -3677.3333           -207.3333         -15962.3333          -3337.3333 </span></span>
<span><span class="co">#&gt;      stateLOUISIANA       stateMARYLAND       stateMICHIGAN      stateMINNESOTA </span></span>
<span><span class="co">#&gt;          -1136.3333           1607.6667          -6392.3333            374.3333 </span></span>
<span><span class="co">#&gt;    stateMISSISSIPPI       stateMISSOURI        stateMONTANA       stateNEBRASKA </span></span>
<span><span class="co">#&gt;          -1951.4444            424.9167          -6072.3333           -353.5833 </span></span>
<span><span class="co">#&gt;         stateNEVADA     stateNEW JERSEY     stateNEW MEXICO       stateNEW YORK </span></span>
<span><span class="co">#&gt;          -4484.3333            274.3333          -1376.3333          -2790.1410 </span></span>
<span><span class="co">#&gt; stateNORTH CAROLINA   stateNORTH DAKOTA           stateOHIO       stateOKLAHOMA </span></span>
<span><span class="co">#&gt;           -194.7333          -1607.3333          -2355.3333          -2060.8333 </span></span>
<span><span class="co">#&gt;         stateOREGON   statePENNSYLVANIA stateSOUTH CAROLINA   stateSOUTH DAKOTA </span></span>
<span><span class="co">#&gt;           1257.6667          -2942.3333           -279.3333           1733.6667 </span></span>
<span><span class="co">#&gt;      stateTENNESSEE          stateTEXAS           stateUTAH        stateVERMONT </span></span>
<span><span class="co">#&gt;            719.1667          -1987.1111          -4144.3333            891.6667 </span></span>
<span><span class="co">#&gt;       stateVIRGINIA </span></span>
<span><span class="co">#&gt;           1007.6667</span></span>
<span></span>
<span><span class="co">## transform data</span></span>
<span><span class="va">string_to_integer</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">column</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">column</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">data_unique</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">8</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_dfc</a></span><span class="op">(</span>.x <span class="op">=</span> <span class="va">data_unique</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">8</span><span class="op">)</span><span class="op">]</span>, .f <span class="op">=</span> <span class="va">tolower</span><span class="op">)</span></span>
<span><span class="va">data_unique</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">8</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">data_unique</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">8</span><span class="op">)</span><span class="op">]</span>, <span class="va">string_to_integer</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">208</span><span class="op">)</span></span>
<span><span class="va">data_unique</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">data_unique</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">data_unique</span><span class="op">$</span><span class="va">out_of_state_total</span><span class="op">)</span></span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">data_unique</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">8</span><span class="op">)</span><span class="op">]</span>,<span class="op">)</span>, <span class="va">dat</span><span class="op">$</span><span class="va">Z</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">data_unique</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">fitkm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kmbayes.html">kmbayes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, Z <span class="op">=</span> <span class="va">Z</span>, X <span class="op">=</span> <span class="va">X</span>, iter <span class="op">=</span> <span class="fl">1000</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>, varsel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Iteration: 100 (10% completed; 2.43274 secs elapsed)</span></span>
<span><span class="co">#&gt; Iteration: 200 (20% completed; 4.73588 secs elapsed)</span></span>
<span><span class="co">#&gt; Iteration: 300 (30% completed; 7.04997 secs elapsed)</span></span>
<span><span class="co">#&gt; Iteration: 400 (40% completed; 9.44783 secs elapsed)</span></span>
<span><span class="co">#&gt; Iteration: 500 (50% completed; 11.75095 secs elapsed)</span></span>
<span><span class="co">#&gt; Iteration: 600 (60% completed; 14.05598 secs elapsed)</span></span>
<span><span class="co">#&gt; Iteration: 700 (70% completed; 16.47354 secs elapsed)</span></span>
<span><span class="co">#&gt; Iteration: 800 (80% completed; 18.77688 secs elapsed)</span></span>
<span><span class="co">#&gt; Iteration: 900 (90% completed; 21.16527 secs elapsed)</span></span>
<span><span class="co">#&gt; Iteration: 1000 (100% completed; 23.57133 secs elapsed)</span></span>
<span><span class="fu"><a href="../reference/ExtractPIPs.html">ExtractPIPs</a></span><span class="op">(</span><span class="va">fitkm</span><span class="op">)</span></span>
<span><span class="co">#&gt;         variable   PIP</span></span>
<span><span class="co">#&gt; 1 room_and_board 1.000</span></span>
<span><span class="co">#&gt; 2  degree_length 1.000</span></span>
<span><span class="co">#&gt; 3          state 0.526</span></span>
<span><span class="co">#&gt; 4             z1 0.194</span></span>
<span><span class="co">#&gt; 5             z2 0.052</span></span>
<span><span class="co">#&gt; 6             z3 0.020</span></span>
<span><span class="co">#&gt; 7             z4 0.126</span></span>
<span><span class="co"># A posteriori inclusion probability in a simulated data set (the bigger the better)</span></span>
<span><span class="co">#TracePlot(fit = fitkm, par = "r", comp = 1)</span></span>
<span><span class="co">#TracePlot(fit = fitkm, par = "sigsq.eps")</span></span>
<span></span>
<span><span class="va">pred.resp.univar</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PredictorResponseUnivar.html">PredictorResponseUnivar</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">fitkm</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">pred.resp.univar</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">z</span>, <span class="va">est</span>, ymin <span class="op">=</span> <span class="va">est</span> <span class="op">-</span> <span class="fl">1.96</span><span class="op">*</span><span class="va">se</span>, ymax <span class="op">=</span> <span class="va">est</span> <span class="op">+</span> <span class="fl">1.96</span><span class="op">*</span><span class="va">se</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">variable</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"The univariate relationship between specific exposure and the total cost"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">'All variables have been standarized to 0~1'</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"Data from the Chronicle of Higher Education"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Scaled Value"</span>, y <span class="op">=</span> <span class="st">"h(z)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Example_analysis_files/figure-html/unnamed-chunk-12-1.png" width="576"></p>
</div>
</div>
<div class="section level3">
<h3 id="summary-of-analysis">Summary of Analysis<a class="anchor" aria-label="anchor" href="#summary-of-analysis"></a>
</h3>
<ul>
<li>The school in California, New York, Massachusetts, and Pennsylvania
showed the top 4 highest deviation in total cost out of state.</li>
<li>The total tution in state showed two kinds of linear association
with room and board. These two patterns can be detected to explore
further.</li>
<li>Even though we considering nuisance parameter, BKMR could identify
the actual effect from room and board cost, degree length and state to
total cost with out of state cost smaller than 20000. Also, in the PIP
value list, room and board, degeree length and state showed the highest
prbability, corrsponding to our expectations.</li>
</ul>
</div>
<div class="section level3">
<h3 id="functions-used-from-packages">Functions used from packages<a class="anchor" aria-label="anchor" href="#functions-used-from-packages"></a>
</h3>
<ul>
<li>dplyr: filter(); select(); summarise(); mutate(); group_by();
left_join() <br>
</li>
<li>tidyr: drop_na(); unite() <br>
</li>
<li>purrr: map_dfc(); map()</li>
<li>ggplot2: geom_point(); geom_(); geom_histogram; geom_smooth,
facet_wrap()</li>
<li>bkmr: ExtractPIPs(); kmbayes(); PredictorResponseUnivar()</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jennifer F. Bobb.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
